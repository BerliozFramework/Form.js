!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):(e=e||self).BerliozCollection=t(e.jQuery)}(this,function(e){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r,a,c,u,d,s,f,t,n,o,g,y,h,m;return e=e&&e.hasOwnProperty("default")?e.default:e,r=e,a="add.collection.berlioz",c="added.collection.berlioz",u="delete.collection.berlioz",d="deleted.collection.berlioz",s="min.collection.berlioz",f="max.collection.berlioz",t="click.add.collection.berlioz",n="click.delete.collection.berlioz",o='[data-add="collection"]',g='[data-delete="collection"]',y="[data-collection]",h="[data-collection-key]",m=function(){function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.target=r(e),this.index=parseInt(this._getCollectionItems().last().attr("data-collection-key")||-1)}var e,t,n;return e=o,n=[{key:"_escapeRegExp",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"_jQueryInterface",value:function(t,n){this.each(function(){var e=r(this).data("collection-object");switch("object"===i(e)&&e instanceof o||r(this).data("collection-object",e=new o(this)),t){case"add":e.addElement();break;case"delete":e.deleteElement(n)}})}}],(t=[{key:"addElement",value:function(){var e=this.index+1,t=r('<div data-collection-key="'+e+'"></div>'),n=this.target.data("prototype").replace(/___name___/g,e);if(!this._controlMaximum()){var o=r.Event(a);if(this.target.trigger(o),!o.isDefaultPrevented()){t.append(r(n));var i=this._getCollectionItems().last();1===i.length?t.insertAfter(i):this.target.prepend(t),this.index=e,this.target.trigger(c)}}}},{key:"deleteElement",value:function(e){if(void 0===(e=r(e)).data("collection-key")&&(e=e.closest(h)),0!==e.length&&!this._controlMinimum()){var t=r.Event(u);this.target.trigger(t),t.isDefaultPrevented()||(e.remove(),this.target.trigger(d))}}},{key:"_nbElements",value:function(){return this._getCollectionItems().length}},{key:"_controlMinimum",value:function(){return(this.target.data("collectionMin")||0)>=this._nbElements()&&(this.target.trigger(s),!0)}},{key:"_controlMaximum",value:function(){var e=this.target.data("collectionMax")||null;return null!==e&&e<=this._nbElements()&&(this.target.trigger(f),!0)}},{key:"_getCollectionItems",value:function(){return this.target.children(h)}}])&&l(e.prototype,t),n&&l(e,n),o}(),r.fn.berliozCollection=m._jQueryInterface,r.fn.berliozCollection.noConflict=function(){return m._jQueryInterface},void r(document).off(t,o).on(t,o,function(e){var t=r(e.currentTarget);(t.data("target")?r('[data-collection="'+t.data("target")+'"]'):t.closest(y)).berliozCollection("add")}).off(n,g).on(n,g,function(e){r(e.currentTarget).parents(y).berliozCollection("delete",r(e.currentTarget).parents(h))})});