{"version":3,"file":"jQueryCollection.js","sources":["../src/Event.js","../src/Collection.js","../src/jQueryCollection.js"],"sourcesContent":["const triggerEvent = (type, element, args) => {\n    const event = new CustomEvent(type, {cancelable: true})\n\n    if (args) {\n        Object.keys(args)\n            .forEach((key) => Object.defineProperty(event,\n                key,\n                {\n                    get() {\n                        return args[key]\n                    }\n                }));\n    }\n\n    element.dispatchEvent(event);\n\n    return event;\n};\n\nexport default triggerEvent;\n","import triggerEvent from \"./Event\";\n\nconst Event = {\n    ADD: 'add.collection.berlioz',\n    ADDED: 'added.collection.berlioz',\n    DELETE: 'delete.collection.berlioz',\n    DELETED: 'deleted.collection.berlioz',\n    MIN: 'min.collection.berlioz',\n    MAX: 'max.collection.berlioz',\n    CLICK_ADD: 'click.add.collection.berlioz',\n    CLICK_DELETE: 'click.delete.collection.berlioz'\n};\n\nconst Selector = {\n    DATA_ADD: '[data-add=\"collection\"]',\n    DATA_REMOVE: '[data-delete=\"collection\"]',\n    COLLECTION: '[data-collection]',\n    COLLECTION_KEY: '[data-collection-key]'\n};\n\nconst Default = {\n    min: 0,\n    max: -1,\n    prototype: null,\n    prototypePlaceholder: 'name',\n};\n\nclass Collection {\n    constructor(target, config) {\n        this._target = target;\n        this._config = {\n            ...Default,\n            ...this._configFromData(target),\n            ...config,\n        };\n        this._config.min = parseInt(this._config.min);\n        this._config.max = parseInt(this._config.max);\n        this._index = parseInt(this.lastItem ? this.lastItem.dataset.collectionKey || -1 : -1);\n\n        this._target._collection = this;\n    }\n\n    _configFromData(element) {\n        let config = {};\n\n        Object.keys(Default).forEach(function (key) {\n            let keyData = 'collection' + key.substring(0, 1).toUpperCase() + key.substring(1);\n\n            if (element.dataset.hasOwnProperty(keyData)) {\n                config[key] = element.dataset[keyData];\n            }\n        });\n\n        return config;\n    }\n\n    get target() {\n        return this._target;\n    }\n\n    get config() {\n        return this._config;\n    }\n\n    get items() {\n        return Array.from(this.target.querySelectorAll(Selector.COLLECTION_KEY))\n            .filter((element) => element.closest(Selector.COLLECTION) === this.target);\n    }\n\n    get index() {\n        return this._index;\n    }\n\n    get firstItem() {\n        return this.items[0] || null;\n    }\n\n    get lastItem() {\n        const items = this.items;\n\n        return items[items.length - 1] || null;\n    }\n\n    add() {\n        if (!this.config.prototype) {\n            console.warn('No prototype declared for collection, unable to add item');\n            return;\n        }\n\n        if (this.isFull()) {\n            return;\n        }\n\n        let tpl = document.createElement('div');\n        tpl.dataset.collectionKey = (++this._index).toString();\n        tpl.innerHTML = this.config.prototype.replace(new RegExp('___' + this.config.prototypePlaceholder + '___', 'g'), this._index);\n\n        // ADD event\n        let event = triggerEvent(Event.ADD, this.target, {collection: this, relatedTarget: tpl});\n\n        if (!event.defaultPrevented) {\n            // Init sub collection\n            tpl.querySelectorAll(Selector.COLLECTION).forEach((element) => {\n                // Already initialized\n                if (element._collection) {\n                    return;\n                }\n\n                new Collection(element);\n            });\n\n            // Insert after last element or to the end\n            if (this.lastItem) {\n                this.lastItem.after(tpl);\n            } else {\n                this.target.append(tpl);\n            }\n\n            triggerEvent(Event.ADDED, this.target, {relatedTarget: tpl, collection: this});\n        }\n\n        return tpl;\n    }\n\n    remove(element) {\n        // If the element doesn't have the key attribute, it may be a child element of the item, so we try to get\n        // the item base element from its parents\n        if (!element.matches(Selector.COLLECTION_KEY)) {\n            if (!(element = element.closest(Selector.COLLECTION_KEY))) {\n                if (element.closest(Selector.COLLECTION) !== this.target) {\n                    console.warn('Try to remove a non item');\n                    return;\n                }\n            }\n        }\n\n        // DELETE event\n        let event = triggerEvent(Event.DELETE, this.target, {relatedTarget: element, collection: this});\n\n        if (this.isMin()) {\n            return;\n        }\n\n        if (!event.defaultPrevented) {\n            element.parentNode.removeChild(element);\n            triggerEvent(Event.DELETED, this.target, {relatedTarget: element, collection: this});\n        }\n\n        return element;\n    }\n\n    isMin() {\n        if (this.config.min > -1 && this.config.min >= this.items.length) {\n            triggerEvent(Event.MIN, this.target, {relatedTarget: this.target, collection: this});\n            return true;\n        }\n\n        return false;\n    }\n\n    isFull() {\n        if (this.config.max > -1 && this.config.max <= this.items.length) {\n            triggerEvent(Event.MAX, this.target, {relatedTarget: this.target, collection: this});\n            return true;\n        }\n\n        return false;\n    }\n}\n\n\n// Events\ndocument.addEventListener('click', (event) => {\n    let button = event.target.closest(Selector.DATA_ADD);\n    if (!button) {\n        return;\n    }\n\n    let collection;\n    if (button.dataset.target) {\n        if (!(collection = document.querySelector(button.dataset.target))) {\n            collection = document.querySelector('[data-collection=\"' + button.dataset.target + '\"]');\n        }\n    } else {\n        collection = button.closest(Selector.COLLECTION);\n    }\n\n    if (collection && collection._collection) {\n        collection._collection.add();\n    }\n});\ndocument.addEventListener('click', (event) => {\n    let button = event.target.closest(Selector.DATA_REMOVE);\n    if (!button) {\n        return;\n    }\n\n    let collectionItem = button.closest(Selector.COLLECTION_KEY);\n\n    if (collectionItem) {\n        let collection = collectionItem.closest(Selector.COLLECTION);\n\n        if (collection && collection._collection) {\n            collection._collection.remove(collectionItem);\n        }\n    }\n});\n\nexport default Collection;\n","import NativeCollection from \"./Collection\";\n\nclass Collection extends NativeCollection {\n    constructor(target, config) {\n        if (target instanceof jQuery) {\n            target = target.get(0);\n        }\n\n        super(target, config);\n    }\n}\n\nconst _jQueryInterface = (action, arg1) => {\n    this.each(function () {\n        let collectionObj = $(this).data('collection-object');\n\n        if (!(collectionObj instanceof Collection)) {\n            $(this).data('collection-object', collectionObj = new Collection($(this).get(0)));\n        }\n\n        switch (action) {\n            case 'add':\n                collectionObj.add();\n                break;\n            case 'delete':\n                collectionObj.remove($(arg1).get(0));\n                break;\n        }\n    })\n}\n\n$.fn.berliozCollection = _jQueryInterface;\n$.fn.berliozCollection.noConflict = function () {\n    return _jQueryInterface;\n};\n\nexport default Collection;\n"],"names":["triggerEvent","type","element","args","event","CustomEvent","cancelable","Object","keys","forEach","key","defineProperty","get","dispatchEvent","Event","ADD","ADDED","DELETE","DELETED","MIN","MAX","CLICK_ADD","CLICK_DELETE","Selector","DATA_ADD","DATA_REMOVE","COLLECTION","COLLECTION_KEY","Default","min","max","prototype","prototypePlaceholder","Collection","target","config","_target","_config","_configFromData","parseInt","_index","lastItem","dataset","collectionKey","_collection","keyData","substring","toUpperCase","hasOwnProperty","Array","from","querySelectorAll","filter","closest","items","length","console","warn","isFull","tpl","document","createElement","toString","innerHTML","replace","RegExp","collection","relatedTarget","defaultPrevented","after","append","matches","isMin","parentNode","removeChild","addEventListener","button","querySelector","add","collectionItem","remove","jQuery","NativeCollection","_jQueryInterface","action","arg1","each","collectionObj","$","data","fn","berliozCollection","noConflict"],"mappings":"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"}